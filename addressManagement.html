<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>BHP</title>
    <link rel="shortcut icon" href="img/logo.png" type="image/x-icon" />
</head>
<style>
    /*地址管理*/
    /*主要内容content*/
    .main{
        width:1108px;
        margin: 0 auto;
        float: right;
        min-height: 50px ;
        /*overflow: hidden;*/
    }
    .top{
        width: 100%;
        height: 62px;
    }
    .title_left{
        width: 1068px;
        margin-left:20px;
        height:62px;
        line-height:62px;
        text-align: left;
    }
    .top> .title_left{
        border-bottom: 1px solid #ebeff0;
    }
    .title_left>span{
        display: inline-block;
        font-size: 16px;
        color: #1D1C1C;
    }
    .title_left>span:first-child{
        font-size: 16px;
        color: #1D1C1C;
    }
    .brand_container{
        width: 1068px;
        margin: 0 auto;
    }
    .brand_container>ul{
        display: flex;
        margin-top: 20px;
        flex-wrap: wrap;
        justify-content: flex-start;
        margin-left: 15px;
        align-items: center;
        align-self: center;
    }
    .brand_container>ul>li{
        width: 156px;
        height: 58px;
        margin-right: 20px;
        align-items: center;
        align-self: center;
        border: 1px solid #EBEFF0;
        cursor: pointer;
    }
    .brand_container>ul>li:focus{
        border: 1px solid #2ec3ee;
    }
    .brand_container>ul>li>div{
        width: 156px;
        height: 58px;
        display: flex;
        flex-direction: column;
        justify-content:center;
    }
    .brand_container>ul>li>div>p, .brand_container>ul>li>div>span{
        color: #1D1C1C;
        align-self:flex-start;
        margin-left:25%;
    }
    .brand_container>ul>li>div>p{
        font-size: 14px;
        color: #1D1C1C;
    }
    .brand_container>ul>li>div>span{
        font-size: 12px;
        color: #B1B1B1;
    }
    .brand_container>ul>li>div>p,.brand_container>ul>li>div>span{
        display: inline;
        align-self:flex-start;
        margin-left:25%;
    }
    .brand_container>ul>li:nth-child(6){
        margin-right: 0;
    }
    .brand_container>ul>li:nth-child(7),.brand_container>ul>li:nth-child(8),.brand_container>ul>li:nth-child(9){
        margin-top: 20px;
    }
    .brand_container>ul>li:first-child{
        border-radius:4px;
        align-items: center;
    }
    .brand_container>ul>li:first-child>div{
        text-align: left;
        width: 156px;
        height: 58px;
        align-items: center;
    }
    .brand_container>ul>li:first-child>div>img, .brand_container>ul>li:nth-child(2)>div>img, .brand_container>ul>li:nth-child(3)>div>img, .brand_container>ul>li:nth-child(4)>div>img, .brand_container>ul>li:nth-child(5)>div>img, .brand_container>ul>li:nth-child(6)>div>img,
    .brand_container>ul>li:nth-child(7)>div>img, .brand_container>ul>li:nth-child(8)>div>img, .brand_container>ul>li:nth-child(9)>div>img{
        display: block;
        width: 20px;
        height: 20px;
        position: absolute;
        top: 20px;
        left: 10px;
    }
    /*自定义样式*/
    .selected{
        display: block;
    }
    .dui_title{
        text-align: left;
        margin-left: 35px;
        height: 62px;
        line-height: 76px;
    }
    .dui_title>span{
        font-size: 14px;
        color: #2ec3ee;
    }
    .add_notice{
        width: 1038px;
        text-align: left;
        margin: 0 auto;
    }
    .add_notice>span{
        display: inline-block;
        margin-left: 14px;
        margin-top: 32px;
        margin-bottom: 20px;
        color: #58c9ff;
    }
    .add_notice>div>p{
        height: 36px;
        line-height: 36px;
        font-size: 14px;
        margin-left: 45px;
        color: #5a5a5a;
    }
    /*拷贝理财记录*/
    .table_container{
        width: 1068px;
        margin: 0 auto;
        border-bottom: 1px solid #ebeff0;
        /*border-bottom: 1px solid red;*/
    }
    .table_container>table{
        width: 100%;
    }
    .table_container>table>thead,.table_container>table>thead>tr{
        width: 100%;
        height: 50px;
        line-height: 50px;
        text-align: center;
    }
    .table_container>table>tbody>tr{
        width: 100%;
        height: 48px;
        line-height: 48px;
        text-align: center;
    }
    table{
        table-layout:auto;
        box-sizing:border-box;
        border-collapse: collapse;
    }
    td{
        border-top:1px solid #ebeff0 ;
        border-bottom:1px solid #ebeff0 ;
    }
    table>tbody tr:nth-child(odd){
        background-color: #fafcfd;
    }
    table>tbody tr:hover{
        background-color: #fbf8f3;
    }
    .table_container>table>thead>tr>th{
        text-align: center;
        font-size: 14px;
        color: #1D1C1C;
    }
    .table_container>table>thead>tr>th:first-child{
        text-align: left;
        padding-left: 30px;
    }
    .table_container>table>tbody>tr>td{
        text-align: center;
        font-size: 15px;
        color: #666;
    }
    .table_container>table>thead>tr>th:nth-child(4),.table_container>table>thead>tr>th:last-child{
        text-align: center;
    }
    .table_container>table>tbody>tr>td:first-child{
        text-align: left;
        padding-left: 30px;
        font-size: 15px;
        color: #1D1C1C;
    }
    .table_container>table>tbody>tr>td:first-child>span{
        display: inline-block;
        height: 48px;
        line-height: 48px;
        vertical-align: middle;
        text-align: center;
    }
    .table_container>table>tbody>tr>td:first-child>img{
        display: inline-block;
        width: 20px;
        vertical-align: middle;
        padding-right: 5px;
    }
    .table_container>table>tbody>tr>td:last-child a{
        font-size: 14px;
        color: #f05e5e;
        text-decoration: underline;
        display: inline-block;
        margin-right: 10px;
    }
    .table_container>table>tbody>tr>td:last-child{
        text-align: right;
    }
    .table_container>table>tbody>tr>td>a{
        display: inline-block;
        font-size: 14px;
        color:#2ec3ee;
    }
    .table_container>table>tbody>tr>td:last-child>span{
        display: inline-block;
        width: 75px!important;
        height: 24px;
        line-height: 24px;
        text-align: center;
        font-size: 14px;
        color: #2ec3ee;
        border: 1px solid #2ec3ee;
        border-radius: 4px;
        /*margin-right: 15px;*/
        cursor: pointer!important;
    }
    .table_container>table>tbody>tr:last-child>td{
        text-align: center;
        font-size: 16px;
        color: #2ec3ee;
        height: 48px;
        line-height: 48px;
    }
    .add_notice{
        margin-bottom: 100px;
    }
</style>
<body>
<!--钱包地址管理记录-->
<div class="main">
    <div class="top">
        <div class="title_left left">
            <span class="string_Wallet_address_management"></span>
        </div>
    </div>
    <div class="brand_container">
        <ul class="walletVos">
        </ul>
    </div>
    <div class="dui_title">
        <span class="availBalance"></span>
    </div>
    <div class="table_container relative">
        <table>
            <thead>
            <tr>
                <th><input type="checkbox" class="choose" disabled/>&nbsp;&nbsp;
                    <span class="string_Choose_the_withdrawal_address"></span>
                </th>
                    <th class="string_Wallet_address_label"></th>
                    <th class="string_Withdrawal_Wallet_address"></th>
                    <th class="string_Status"></th>
                    <th class="string_Operating"></th>
            </tr>
            </thead>
            <tbody id="tbody">
            </tbody>
        </table>
        <div class="add_addr">
            <form action="">
                <div>
                    <span>
                        <label for="addr_label" class="string_Wallet_address_label"></label>：
                        <input type="text"class='string_eg'id="addr_label"name="addr_label"/>
                    </span>
                </div>
                <div>
                    <span>
                        <label for="addr_wallet" class="string_Withdrawal_Wallet_address"></label>：
                        <input type="text" class='string_egCode' id="addr_wallet"name="addr_wallet"/>
                    </span>
                </div>
                <div>
                    <span class="relative">
                        <label for="valiCode" class="string_E-mail_verification_code"></label>：
                        <input type="text"id="valiCode" class="string_Please_input_the_verification_code" name="valiCode"/>
                        <a href="javascript:" class="getValiCode getValiCode_Adrr_manage"></a>
                         <span class="sendTips addrM_tips sended"></span>
                    </span>
                </div>
                <input type="button"  class="comfirm_btn"/>
                <input type="button"  class="cancel_btn"/>
            </form>
        </div>
    </div>
    <div class="add_notice marginBottom100">
        <span class="string_Address_added_explanation"></span>
        <div>
            <p></p><p></p>
        </div>
    </div>
</div>
<script>
    function loadProperties(language){
        jQuery.i18n.properties({//加载资浏览器语言对应的资源文件
            name:'strings', //资源文件名称
            language:language,
            path:'components/i18n/resources/i18n/', //资源文件路径
            mode:'map', //用Map的方式使用资源文件中的值
            callback: function() {//加载成功后设置显示内容
//                已发送
                $('.sended').html($.i18n.prop('sended'));
//                钱包地址管理
                $('.string_Wallet_address_management').html($.i18n.prop('string_Wallet_address_management'));
                //转出地址标签
                $('.string_Wallet_address_label').html($.i18n.prop('string_Wallet_address_label'));
                //转出钱包地址
                $('.string_Withdrawal_Wallet_address').html($.i18n.prop('string_Withdrawal_Wallet_address'));
                //状态
                $('.string_Status').html($.i18n.prop('string_Status'));
                //操作
                $('.string_Operating').html($.i18n.prop('string_Operating'));
                //请输入验证码
                $('.string_Please_input_the_verification_code').attr('placeholder',$.i18n.prop('string_Please_input_the_verification_code'));
                //获取验证码
                $('.getValiCode_Adrr_manage').html($.i18n.prop('string_Send_verification_code'));
                //邮箱验证码
                $('.string_E-mail_verification_code').html($.i18n.prop('string_E-mail_verification_code'));
                //确定
                $('.comfirm_btn').attr('value',$.i18n.prop('string_Confirm'));
                //取消
                $('.cancel_btn').attr('value',$.i18n.prop('string_Cancel'));
                //地址添加说明
                $('.string_Address_added_explanation').html($.i18n.prop('string_Address_added_explanation'));
//                地址添加说明
                var notice_addrs=['notice_addr_1', 'notice_addr_2'];
                each_menu('.add_notice>div>p',notice_addrs);
                //例如 Silian的地址
                $('.string_eg').attr('placeholder',$.i18n.prop('string_eg'));
                //例如 ：0x3f44ca37879d1255e5036ebc4fb1e069233f07105.005689
                $('.string_egCode').attr('placeholder',$.i18n.prop('string_egCode'));
            }
        });
    }
    var language = window.localStorage.language;
    if(!language){
        window.localStorage.language='zh-CN';
        language='zh-CN';
    }
    loadProperties(language);
    $(function(){
        var token=window.localStorage.token;
        var timerCount=null;
        var isGet=false;
        var language = window.localStorage.language;
        var  NewAddr=language=='zh-CN'?'添加一个新的提币地址':'Click to add a new withdrawal address';
        //请求is_login 判断是否正常登陆
        $.ajax({
            type:"POST",
            url:config.domain+"/api/v2/user/is_login",
            data:{
                token:token,
                language:language
            },
            dataType:"json",
            success:function(res){
                console.log("这是is_login个人信息响应");
                language = window.localStorage.language;
                if(res.code==200) {
                    var type;
                    var defaultType=10;
                    var language = window.localStorage.language;
                    var  Default=language=='zh-CN'?'默认':'Default';
                    var  set_as_Default=language=='zh-CN'?'设为默认':'default on';
                    var  Cancel_Default=language=='zh-CN'?'取消默认':'default off';
                    var  Delete=language=='zh-CN'?'删除':'Delete';
                    var  is_Delete=language=='zh-CN'?'是否删除':'are you sure to delete?';
                    var  authentication=language=='zh-CN'?'已认证':'Verified';
                    var  Confirm_setting_as_default_address=language=='zh-CN'?'确认设置为默认地址':'Confirm setting as default address';
                    var  Confirm_cancellation_of_default_address=language=='zh-CN'?'确认取消默认地址':'Confirm cancellation of default address';
                    //     GET /api/v2/user/bhpc_manage
                    $.ajax({
                        type:"GET",
                        url:config.domain+"/api/v2/user/address_manage",
                        data:{
                            token:token,
                            language:language
                        },
                        dataType:"json",
                        success:function(res){
                            console.log("这是_钱包地址页面");
                            console.log(res);
                            if(res.code==200){
                                var walletVos=res.obj.walletVos;
                                var html="";
                                for(var w of walletVos){
                                    var img_src="img/coinType_logo/"+ w.name+".png";
//                    不同币种切换
                                    html+=`
                     <li data-coinName=${w.chineseName} data-availBalance=${w.availBalance} data-coinType=${w.type} data-name=${w.name}>
                        <div class="relative">
                            <p>${w.chineseName} ${w.name}</p>
                            <span>${w.availBalance}</span>
                            <img src=${img_src} alt=""/>
                            <i class="choose_icon"></i>
                        </div>
                     </li>
                    `;
                                }
                                $(".walletVos").html(html);
                            }
                            // 币种点击变化
                            $(".brand_container li").each(function(){
                                var $tar=$(this);
                                type=parseInt($tar.attr("data-coinType"));
                                if(type==defaultType){
                                    sessionStorage.setItem("currentCoinType",type);
                                    coinChange($tar);
                                    var currentAvailBalance=$tar.attr("data-availBalance");
                                    var currentCoinName=$tar.attr("data-name");
                                    var language = window.localStorage.language;
                                    var html='';
                                    html+=language=='zh-CN'?`可用 ${currentCoinName} 余额: ${currentAvailBalance}`:`${currentCoinName} Available balance: ${currentAvailBalance}`;
                                    $(".availBalance").html(html);
//        POST /api/v2/user/show_wallet_address
                                    $.ajax({
                                        type:'POST',
                                        url:config.domain+"/api/v2/user/show_wallet_address",
                                        data:{
                                            token:token,
                                            type:type,
                                            language:language
                                        },
                                        dataType:'json',
                                        success:function(res){
                                            console.log("这是显示单个钱包提币地址页面");
                                            console.log(res);
                                            if(res.code==200){
                                                var withDrawAddressVos=res.obj.withDrawAddress;
                                                var html="";
                                                //提币地址显示
                                                for(var a of withDrawAddressVos){
                                                    if(a.defaultStatus==2){
                                                        html+=`
                        <tr>
                        <td><input type="checkbox" class="choose" checked style="border:1px solid #2ec3ee;"/>
                            <span style="color: #2ec3ee;font-size: 14px;">${Default}</span>
                        </td>
                        <td>${a.addressLabel}</td><td>${a.address}</td>
                        <td>${authentication}</td>
                        <td style="text-align: center;">
                        <a data-defaultStatus=${a.defaultStatus} data-delete="delete" data-withDrawAddressId=${a.withDrawAddressId}>${Delete}</a>
                        <span class="cancelDefault" data-defaultStatus=${a.defaultStatus} data-withDrawAddressId=${a.withDrawAddressId}data-type=${a.type}>${Cancel_Default}</span>
                        </td>
                     </tr>
                        `;
                                                    }
                                                    else{
                                                        html+=`
                     <tr>
                        <td><input type="checkbox" class="choose"/></td>
                        <td>${a.addressLabel}</td><td>${a.address}</td>
                        <td>${authentication}</td>
                        <td style="text-align: center;">
                        <a data-defaultStatus=${a.defaultStatus} data-delete="delete" data-withDrawAddressId=${a.withDrawAddressId}>${Delete}</a>
                        <span class="setdefault" data-defaultStatus=${a.defaultStatus} data-withDrawAddressId=${a.withDrawAddressId} data-addr=${a.address} data-type=${a.type}>${set_as_Default}</span>
                        </td>
                     </tr> `;
                                                    }
                                                }
//                                    添加地址
                                                html+=`
                    <tr>
                      <td colspan="5" class="toAdd_addr">${NewAddr}</td>
                    </tr>
                `;
                                                $("#tbody").html(html);
                                                //地址管理页点击添加新地址
                                                $(".toAdd_addr").off("click").click(function(){
                                                    $(this).hide();
                                                    $(".add_addr").show();
                                                });
                                                //        设为默认地址POST /api/v2/user/add_default_address
                                                $(".setdefault").off("click").click(function(){
                                                    if(confirm(Confirm_setting_as_default_address)){
                                                        var $tar=$(this);
                                                        var type=$tar.attr("data-type");
//                                             POST /api/v2/user/add_default_address
                                                        var withDrawAddressId=parseInt($tar.attr("data-withDrawAddressId"));
                                                        $.ajax({
                                                            type:"POST",
                                                            url:config.domain+"/api/v2/user/add_default_address",
                                                            data:{
                                                                type:type,
                                                                token:token,
                                                                withDrawAddressId:withDrawAddressId,
                                                                language:language
                                                            },
                                                            dataType:"json",
                                                            success:function(res){
                                                                console.log("这是设置默认地址响应");
                                                                console.log(res);
                                                                alert(res.msg);
                                                                if(res.code==200) {
                                                                    $(".iframe2").load("addressManagement.html");
                                                                }
                                                            },
                                                            error:function(){
                                                                alert($.i18n.prop('network_error'));
                                                            }
                                                        });
                                                    }
                                                });
//        取消默认 POST /api/v2/user/cancle_default_address
                                                $(".cancelDefault").off("click").click(function(){
                                                    if(confirm(Confirm_cancellation_of_default_address)){
//                           POST /api/v2/user/cancle_default_address
                                                        var $tar=$(this);
                                                        var address=$tar.data("addr");
                                                        $tar.attr("data-defaultStatus","1");
                                                        var defaultStatus=1;
                                                        var withDrawAddressId=parseInt($tar.attr("data-withDrawAddressId"));
                                                        $.ajax({
                                                            type:"POST",
                                                            url:config.domain+"/api/v2/user/cancle_default_address",
                                                            data:{
                                                                token:token,
                                                                defaultStatus:defaultStatus,
                                                                withDrawAddressId:withDrawAddressId,
                                                                address:address,
                                                                language:language
                                                            },
                                                            dataType:"json",
                                                            success:function(res){
                                                                console.log("这是取消默认地址响应");
                                                                console.log(res);
                                                                alert(res.msg);
                                                                if(res.code==200) {
                                                                    $(".iframe2").load("addressManagement.html");
                                                                }
                                                            },
                                                            error:function(){
                                                               alert($.i18n.prop('network_error'));
                                                            }
                                                        });
                                                    }
                                                });
//                    删除地址 POST /api/v2/user/remove_address
                                                $("[data-delete='delete']").off("click").click(function(e){
                                                    e.preventDefault();
                                                    var withDrawAddressId=$(e.target).attr("data-withDrawAddressId");
                                                    console.log(withDrawAddressId);
                                                    if(confirm(is_Delete)){
                                                        $.ajax({
                                                            type:'POST',
                                                            url:config.domain+"/api/v2/user/remove_address",
                                                            data:{
                                                                token:token,
                                                                withDrawAddressId:withDrawAddressId,
                                                                language:language
                                                            },
                                                            dataType:'json',
                                                            success:function(res){
                                                                alert(res.msg);
                                                                if(res.code==200) {
                                                                    $(".iframe2").load("addressManagement.html");
                                                                }
                                                            },
                                                            error:function(){
                                                               alert($.i18n.prop('network_error'));
                                                            }
                                                        });
                                                    }
                                                });
                                            }
                                        },
                                        error:function(){
                                           alert($.i18n.prop('network_error'));
                                        }
                                    });
                                }
//                    可用余额
//                    点击币种显示对应钱包地址
                                $tar.off("click").click(function(){
                                    var $tar=$(this);
                                    $("#valiCode").val('');
                                    $("#addr_label").val('');
                                    $("#addr_wallet").val('');
                                    $(".add_addr").hide();
                                    type=parseInt($tar.attr("data-coinType"));
                                    sessionStorage.setItem("currentCoinType",type);
                                    var currentAvailBalance=$tar.attr("data-availBalance");
                                    var currentCoinName=$tar.attr("data-name");
                                    coinChange($tar);
                                    var language = window.localStorage.language;
                                    var html='';
                                    html+=language=='zh-CN'?`可用 ${currentCoinName} 余额: ${currentAvailBalance}`:`${currentCoinName} Available balance: ${currentAvailBalance}`;
                                    $(".availBalance").html(html);
                                    //        POST /api/v2/user/show_wallet_address
                                    $.ajax({
                                        type:'POST',
                                        url:config.domain+"/api/v2/user/show_wallet_address",
                                        data:{
                                            token:token,
                                            type:type,
                                            language:language
                                        },
                                        dataType:'json',
                                        success:function(res){
                                            console.log("这是显示单个钱包提币地址页面");
                                            console.log(res);
                                            if(res.code==200){
                                                var withDrawAddressVos=res.obj.withDrawAddress;
                                                var html="";
                                                //提币地址显示
                                                for(var a of withDrawAddressVos){
                                                    if(a.defaultStatus==2){
                                                        html+=`
                        <tr>
                        <td><input type="checkbox" class="choose" checked style="border:1px solid #2ec3ee;"/>
                            <span style="color: #2ec3ee;font-size: 14px;">${Default}</span>
                        </td>
                        <td>${a.addressLabel}</td><td>${a.address}</td>
                        <td>${authentication}</td>
                        <td style="text-align: center;">
                        <a data-defaultStatus=${a.defaultStatus} data-delete="delete" data-withDrawAddressId=${a.withDrawAddressId}>${Delete}</a>
                        <span class="cancelDefault" data-defaultStatus=${a.defaultStatus} data-withDrawAddressId=${a.withDrawAddressId}data-type=${a.type}>${Cancel_Default}</span>
                        </td>
                     </tr>
                        `;
                                                    }
                                                    else{
                                                        html+=`
                     <tr>
                        <td><input type="checkbox" class="choose"/></td>
                        <td>${a.addressLabel}</td><td>${a.address}</td>
                        <td>${authentication}</td>
                        <td style="text-align: center;">
                        <a data-defaultStatus=${a.defaultStatus} data-delete="delete" data-withDrawAddressId=${a.withDrawAddressId}>${Delete}</a>
                        <span class="setdefault" data-defaultStatus=${a.defaultStatus} data-withDrawAddressId=${a.withDrawAddressId} data-addr=${a.address} data-type=${a.type}>${set_as_Default}</span>
                        </td>
                     </tr> `;
                                                    }
                                                }
//                                    添加地址
                                                html+=`
                    <tr>
                      <td colspan="5" class="toAdd_addr">${NewAddr}</td>
                    </tr>
                `;
                                                $("#tbody").html(html);
    //地址管理页点击添加新地址
                                                $(".toAdd_addr").off("click").click(function(){
                                                    $(this).hide();
                                                    $(".add_addr").show();
                                                });
//        设为默认地址POST /api/v2/user/add_default_address
                                                $(".setdefault").off("click").click(function(){
                                                    if(confirm(Confirm_setting_as_default_address)){
                                                        var $tar=$(this);
                                                        var type=$tar.attr("data-type");
//                                             POST /api/v2/user/add_default_address
                                                        var withDrawAddressId=parseInt($tar.attr("data-withDrawAddressId"));
                                                        $.ajax({
                                                            type:"POST",
                                                            url:config.domain+"/api/v2/user/add_default_address",
                                                            data:{
                                                                type:type,
                                                                token:token,
                                                                withDrawAddressId:withDrawAddressId,
                                                                language:language
                                                            },
                                                            dataType:"json",
                                                            success:function(res){
                                                                console.log("这是设置默认地址响应");
                                                                console.log(res);
                                                                alert(res.msg);
                                                                if(res.code==200) {
                                                                    $(".iframe2").load("addressManagement.html");
                                                                }
                                                            },
                                                            error:function(){
                                                               alert($.i18n.prop('network_error'));
                                                            }
                                                        });
                                                    }
                                                });
        //        取消默认 POST /api/v2/user/cancle_default_address
                                                $(".cancelDefault").off("click").click(function(){
                                                    if(confirm(Confirm_cancellation_of_default_address)){
//                           POST /api/v2/user/cancle_default_address
                                                        var $tar=$(this);
                                                        var address=$tar.data("addr");
                                                        $tar.attr("data-defaultStatus","1");
                                                        var defaultStatus=1;
                                                        var withDrawAddressId=parseInt($tar.attr("data-withDrawAddressId"));
                                                        $.ajax({
                                                            type:"POST",
                                                            url:config.domain+"/api/v2/user/cancle_default_address",
                                                            data:{
                                                                token:token,
                                                                defaultStatus:defaultStatus,
                                                                withDrawAddressId:withDrawAddressId,
                                                                address:address,
                                                                language:language
                                                            },
                                                            dataType:"json",
                                                            success:function(res){
                                                                console.log("这是取消默认地址响应");
                                                                console.log(res);
                                                                alert(res.msg);
                                                                if(res.code==200) {
                                                                    $(".iframe2").load("addressManagement.html");
                                                                }
                                                            },
                                                            error:function(){
                                                               alert($.i18n.prop('network_error'));
                                                            }
                                                        });
                                                    }
                                                });
    //                    删除地址 POST /api/v2/user/remove_address
                                                $("[data-delete='delete']").off("click").click(function(e){
                                                    e.preventDefault();
                                                    var withDrawAddressId=$(e.target).attr("data-withDrawAddressId");
                                                    if(confirm(is_Delete)){
                                                        $.ajax({
                                                            type:'POST',
                                                            url:config.domain+"/api/v2/user/remove_address",
                                                            data:{
                                                                token:token,
                                                                withDrawAddressId:withDrawAddressId,
                                                                language:language
                                                            },
                                                            dataType:'json',
                                                            success:function(res){
                                                                alert(res.msg);
                                                                if(res.code==200) {
                                                                    $(".iframe2").load("addressManagement.html");
                                                                }
                                                            },
                                                            error:function(){
                                                               alert($.i18n.prop('network_error'));
                                                            }
                                                        });
                                                    }
                                                });
                                            }
                                        },
                                        error:function(){
                                           alert($.i18n.prop('network_error'));
                                        }
                                    });
                                });
                            });
    //     点击按钮获取验证码  POST /api/v2/user/fetch_my_email_verify_code
                            $(".getValiCode_Adrr_manage").off("click").click(function(e){
                                e.preventDefault();
                                if(isGet){
                                    return;
                                }
                                isGet=true;
                                $.ajax({
                                    type:'POST',
                                    url:config.domain+'/api/v2/user/fetch_withdraw_email_verify_code',
                                    data:{
                                        token:token,
                                        language:language
                                    },
                                    dataType:'json',
                                    success:function(res){
                                        console.log(res);
                                        alert(res.msg);
                                        if(res.code==200) {

                                        }else{
                                            clearInterval(timerCount);
                                            timerCount=null;
                                            isGet=false;
                                            $(".getValiCode_Adrr_manage").html($.i18n.prop('string_Send_verification_code')).css("cursor","pointer");
                                        }
                                    },
                                    error:function(){
                                       alert($.i18n.prop('network_error'));
                                    }
                                });
                                var count=60;

                                timerCount=setInterval(function(){
                                    count--;
                                    if(count==0){
                                        clearInterval(timerCount);
                                        timerCount=null;
                                        isGet=false;
                                        $(".getValiCode_Adrr_manage").html($.i18n.prop('string_Send_verification_code')).css("cursor","pointer");
                                    }else{
                                        if(count>55){
                                            $(".addrM_tips").show();
                                        }else{
                                            $(".addrM_tips").hide();
                                        }
                                        $(".getValiCode_Adrr_manage").html(`${count}s`).css("cursor","none");
                                    }
                                },1000)
                            });
        // 点击确定按钮       新增地址 POST /api/v2/user/add_address
                            $(".comfirm_btn").off("click").click(function(e){
                                e.preventDefault();
                                clearInterval(timerCount);
                                timerCount=null;
                                $(".getValiCode_Adrr_manage").html($.i18n.prop('string_Send_verification_code')).css("cursor","pointer");
                                $(".addrM_tips").hide();
                                isGet=false;
                                var type=sessionStorage.getItem("currentCoinType",type);
                                var addressLabel=$("#addr_label").val();
                                var address=$("#addr_wallet").val();
                                if(addressLabel==""||address==""){
                                    alert($.i18n.prop('alert_addr_empty'));
                                    return;
                                }
                                if(type==undefined){
                                    alert($.i18n.prop('alert_choose_token'));
                                    return;
                                }
                                var verify=$("#valiCode").val();
                                var reg=/^[A-Za-z0-9]{5}$/;
                                if(!reg.test(verify)) {
                                    alert($.i18n.prop('alert_code_format'));
                                    $("#valiCode").val('');
                                    return;
                                }
                                $.ajax({
                                    type:'POST',
                                    url:config.domain+"/api/v2/user/add_address",
                                    data:{
                                        addressLabel:addressLabel,
                                        address:address,
                                        type:type,
                                        verify:verify,
                                        token:token,
                                        language:language
                                    },
                                    dataType:'json',
                                    success:function(res){
                                        alert(res.msg);
                                        if(res.code==200) {
                                            $(".iframe2").load("addressManagement.html");
                                        }
                                        $("#valiCode").val('');
                                        $("#addr_label").val('');
                                        $("#addr_wallet").val('');
                                    },
                                    error:function(){
                                       alert($.i18n.prop('network_error'));
                                    }
                                });
                            });
//点击取消按钮返回当前页面
                            $(".cancel_btn").off("click").click(function(){
                                $("#valiCode").val('');
                                $("#addr_label").val('');
                                $("#addr_wallet").val('');
                                $(".toAdd_addr").show();
                                $(".add_addr").hide();
                                clearInterval(timerCount);
                                timerCount=null;
                                $(".getValiCode_Adrr_manage").html($.i18n.prop('string_Send_verification_code')).css("cursor","pointer");
                                $(".addrM_tips").hide();
                                isGet=false;
                            });
                        },
                        error:function(){
                           alert($.i18n.prop('network_error'));
                        }
                    });
                }
                else{
                    alert(res.msg);
//                    window.location="login.html";
                    window.localStorage.language=language;
                    //window.location="login.html";
                    window.location=config.myWeb+'/login.html';
                    //alert(res.msg)
                }
            },
            error:function(){
                alert("network error");
            }
        });

    });
</script>
</body>
</html>
